---
toc_min_heading_level: 2
toc_max_heading_level: 4
---

# ğŸ§ª TP3 â€“ Super RPG Infini

---

## ğŸ¯ Objectif du TP3

BÃ¢tir, en console C#, un petit jeux en trois parties :

### Partie 1 â€“ Navigation dans un donjon
- ğŸ° **Un donjon 3x3** reprÃ©sentÃ© par une grille
- ğŸ‘£ **DÃ©placement du joueur** (Nord, Sud, Est, Ouest)
- âœ… **Suivi des salles visitÃ©es**
- ğŸ­ **Affichage de la position du joueur** et du donjon en console
- ğŸ”„ **Boucle de navigation** avec option *Quitter*
- ğŸ† **Fin de partie**

![Navigation](_02-tp2/Navigation.png)
---

### Partie 2 â€“ CrÃ©er de nouveaux donjons
- DÃ©tails Ã  venir

### Partie 3 â€“ Ã‰vÃ¨nements dans les salles du donjon
- ğŸ­ **Affichage avancÃ©e** du donjon et de la position du joueur

---


## ğŸ”¹ Progression

##### Partie 1 â€“ Donjon
1. DÃ©finir les variables et le tableau du donjon  
2. Afficher le donjon avec la position du joueur  
3. Proposer des dÃ©placements valides (N, S, E, O)  
4. Mettre Ã  jour la position et marquer les salles visitÃ©es
5. CrÃ©er un menu de navigation complet
6. Fin de la partie

---
## ğŸ° Partie 1 â€“ Navigation dans un donjon

---
### Ã‰tape 1 â€” DÃ©finir les variables et le tableau du donjon

#### ğŸ¯ Objectif

Mettre en place un **donjon simple sous forme de grille (3x3)** dans lequel le joueur pourra se dÃ©placer.  
Chaque salle est reprÃ©sentÃ©e par un emoji pour rendre lâ€™affichage plus visuel.

---


#### 1ï¸âƒ£ DÃ©finir le donjon

On utilise un **tableau Ã  2 dimensions (`string[,]`)** pour reprÃ©senter le donjon.  
Chaque case contient un symbole qui reprÃ©sente une salle.

```csharp
// Ajout d'un donjon (3x3)
static string[,] donjon = new string[3, 3]
{
    { "ğŸ—¿", "ğŸ’€", "ğŸ’" },
    { "ğŸ‘¹", "ğŸ§™â€", "ğŸ—" },
    { "ğŸšª", "ğŸ§Ÿ", "ğŸ‘º" }
};
```

ğŸ‘‰ Ici le donjon est une **grille de 3 lignes Ã— 3 colonnes**.  
Exemple visuel :

```
ğŸ—¿   ğŸ’€   ğŸ’
ğŸ‘¹   ğŸ§™â€   ğŸ—
ğŸšª   ğŸ§Ÿ   ğŸ‘º
```

---

#### 2ï¸âƒ£ Suivi des salles visitÃ©es

On doit savoir si une salle a dÃ©jÃ  Ã©tÃ© visitÃ©e par le joueur ou non.  
On crÃ©e donc un **tableau parallÃ¨le de boolÃ©ens (`true` ou `false`)** :

```csharp
// Pour savoir si une piÃ¨ce a Ã©tÃ© visitÃ©e ou non
static bool[,] donjonVisite = new bool[3, 3];
```

ğŸ‘‰ Au dÃ©part toutes les cases contiennent `false` (non visitÃ©es).  
On mettra `true` lorsquâ€™un joueur entre dans une salle.

---

#### 3ï¸âƒ£ Position du joueur

On garde la position du joueur avec deux entiers :

```csharp
// Position du joueur dans le donjon
static int positionLigne = 0, positionColonne = 0;
```

- `positionLigne` â†’ ligne (0 = premiÃ¨re ligne, 1 = deuxiÃ¨me, etc.)  
- `positionColonne` â†’ colonne (0 = premiÃ¨re colonne, 1 = deuxiÃ¨me, etc.)  

ğŸ‘‰ Au dÃ©part le joueur est placÃ© en haut Ã  gauche (0,0).

---

#### âœ… Test rapide

Ajoute un affichage temporaire dans `Tests()` :

```csharp
Console.WriteLine("=== Donjon initial ===");
for (int ligne = 0; ligne < donjon.GetLength(0); ligne++)
{
    for (int colonne = 0; colonne < donjon.GetLength(1); colonne++)
    {
        Console.Write(donjon[ligne, colonne] + " ");
    }
    Console.WriteLine();
}

Console.WriteLine($"Position du joueur : ({positionLigne},{positionColonne})");
```

#### ğŸ¬ RÃ©sultat attendu

```
=== Donjon initial ===
ğŸ—¿ ğŸ’€ ğŸ’ 
ğŸ‘¹ ğŸ§™â€ ğŸ— 
ğŸšª ğŸ§Ÿ ğŸ‘º 
Position du joueur : (0,0)
```

---

ğŸ‘‰ Prochaine Ã©tape : afficher le donjon **avec la position du joueur mise en Ã©vidence** (par exemple avec "ğŸ˜ƒ" Ã  la place de la case).

### Ã‰tape 2 â€” Afficher le donjon avec la position du joueur

#### ğŸ¯ Objectif

Mettre en place une fonction qui permet :

- dâ€™afficher le donjon (3x3) en console  
- de montrer la position du joueur avec un emoji distinct (ex. ğŸ˜ƒ)  
- de diffÃ©rencier les salles visitÃ©es et non visitÃ©es  

---

#### 1ï¸âƒ£ Instructions

1. Parcourir toutes les cases du donjon avec **deux boucles imbriquÃ©es** (une pour les lignes, une pour les colonnes).  
2. Pour chaque case :  
   - Si la position du joueur correspond Ã  la case (`positionLigne`, `positionColonne`) â†’ afficher un emoji spÃ©cial pour reprÃ©senter le joueur.  
   - Sinon â†’ afficher lâ€™emoji de la salle.  
3. Modifier la couleur ou le style selon si la salle a dÃ©jÃ  Ã©tÃ© visitÃ©e (`donjonVisite[ligne, colonne] == true`).  
4. Nâ€™oubliez pas de revenir Ã  la ligne aprÃ¨s chaque rangÃ©e pour bien afficher la grille 3x3.  
5. ğŸ’¡ Astuce : vous pouvez aussi changer la **couleur de fond** avec `Console.BackgroundColor` pour encore mieux diffÃ©rencier les cases.  

---

#### 2ï¸âƒ£ Pseudo-code

```pseudo
fonction AfficherDonjon()
    pour ligne de 0 Ã  2
        pour colonne de 0 Ã  2
            si (ligne == positionLigne et colonne == positionColonne)
                afficher "emoji joueur"
            sinon si (donjonVisite[ligne, colonne] == vrai)
                afficher "emoji de la salle en mode visitÃ©"
            sinon
                afficher "emoji de la salle en mode non visitÃ©"
        fin pour
        saut de ligne dans la console
    fin pour
fin fonction
```

---

#### 3ï¸âƒ£ Test rapide

Dans votre fonction `Tests()` :  

- Marquez la salle de dÃ©part comme visitÃ©e (`donjonVisite[positionLigne, positionColonne] = true`).  
- Appelez `AfficherDonjon()`.  
- Simulez la visite dâ€™une autre salle en modifiant `donjonVisite[ligne, colonne]` et affichez de nouveau.  

---

#### ğŸ¬ RÃ©sultat attendu

- Le joueur apparaÃ®t avec un emoji distinct (ğŸ˜ƒ par exemple).  
- Les salles visitÃ©es apparaissent dans un style diffÃ©rent (ex. gris).  
- Les salles non visitÃ©es apparaissent normales (ex. cyan).  
- On peut aussi utiliser une **couleur de fond diffÃ©rente** pour mieux distinguer les cases.  
- La grille 3x3 du donjon est correctement affichÃ©e.  

---

### Ã‰tape 3 â€” Afficher les options de dÃ©placement

#### ğŸ¯ Objectif

Permettre au joueur de voir **dans quelles directions il peut se dÃ©placer** Ã  partir de sa position actuelle dans le donjon.

---

#### 1ï¸âƒ£ SchÃ©ma du donjon (coordonnÃ©es)

```
    (0, 0) â”€â”€â–º colonne

      â”‚
      â–¼
    ligne
```

- `positionLigne` â†’ position verticale (lignes)
- `positionColonne` â†’ position horizontale (colonnes)

---

#### 2ï¸âƒ£ Instructions

1. CrÃ©e une fonction `AfficherOptionsDeplacement()`.
2. VÃ©rifie la position actuelle du joueur avec `positionLigne` et `positionColonne`.
3. Si un dÃ©placement est possible, affiche la direction correspondante :
   - Nord (N) â†’ `positionLigne > 0`
   - Sud (S) â†’ `positionLigne < donjon.GetLength(0) - 1`
   - Ouest (O) â†’ `positionColonne > 0`
   - Est (E) â†’ `positionColonne < donjon.GetLength(1) - 1`
4. Si une direction nâ€™est pas possible (bord du donjon), ne rien afficher pour cette direction.

---

#### 3ï¸âƒ£ Pseudo-code

```pseudo
fonction AfficherOptionsDeplacement()
    si positionLigne > 0
        afficher "N â†’ Une salle au nord"

    si positionLigne < donjon.GetLength(0) - 1
        afficher "S â†’ Une salle au sud"

    si positionColonne > 0
        afficher "O â†’ Une salle Ã  lâ€™ouest"

    si positionColonne < donjon.GetLength(1) - 1
        afficher "E â†’ Une salle Ã  lâ€™est"
fin fonction
```

---

#### âœ… Test rapide

Ajoute dans ta fonction `Tests()` :

```csharp
AfficherOptionsDeplacement();
```

DÃ©place manuellement `positionLigne` et `positionColonne` pour vÃ©rifier que les directions affichÃ©es sont correctes selon la position.

---

#### ğŸ¬ RÃ©sultat attendu

- Si le joueur est en haut Ã  gauche `(0,0)` â†’ seulement Est et Sud sont possibles.  
- Si le joueur est au centre `(1,1)` â†’ toutes les directions sont possibles.  
- Si le joueur est en bas Ã  droite `(2,2)` â†’ seulement Nord et Ouest sont possibles.  

### Ã‰tape 4 â€” Menu de navigation

#### ğŸ¯ Objectif

CrÃ©er un **menu interactif** permettant au joueur de se dÃ©placer dans le donjon jusquâ€™Ã  ce quâ€™il choisisse de quitter.

---


#### 1ï¸âƒ£ Instructions

1. CrÃ©er une fonction `MenuNavigation()`.
2. Marquer la case de dÃ©part comme visitÃ©e (`donjonVisite[positionLigne, positionColonne] = true;`).
3. Dans une boucle infinie (`for(;;)` ou `while(true)`), faire :  
   - Afficher le donjon (`AfficherDonjon()`)  
   - Afficher les options de dÃ©placement (`AfficherOptionsDeplacement()`)  
   - Afficher lâ€™option `Q â†’ Quitter`  
   - Lire le choix de lâ€™utilisateur  
   - Si choix = `Q` â†’ sortir de la fonction  
   - Sinon â†’ appeler `DeplacerJoueur(choix)`  
4. RÃ©pÃ©ter tant que lâ€™utilisateur nâ€™a pas quittÃ©.

---

#### 2ï¸âƒ£ Pseudo-code

```pseudo
fonction MenuNavigation()
    marquer la case (positionLigne, positionColonne) comme visitÃ©e

    rÃ©pÃ©ter indÃ©finiment
        afficher donjon
        afficher options de dÃ©placement
        afficher "Q â†’ Quitter"

        lire le choix du joueur

        si choix == "Q"
            sortir de la boucle

        sinon
            DeplacerJoueur(choix)
fin fonction
```

---

#### 3ï¸âƒ£ Test rapide

Ajoute dans `Main()` :

```csharp
MenuNavigation();
```

---

#### ğŸ¬ RÃ©sultat attendu

- Le joueur voit le donjon et sa position (`ğŸ˜ƒ`).  
- Les salles visitÃ©es changent de couleur (ou Ã©tat).  
- Les options de dÃ©placement disponibles sâ€™affichent selon la position.  
- Entrer une direction valide â†’ dÃ©place le joueur.  
- Entrer `Q` â†’ quitte la navigation.  


### Ã‰tape 5 â€” DÃ©placer le joueur

#### ğŸ¯ Objectif

Mettre Ã  jour la **position du joueur** dans le donjon en fonction du choix de direction, et marquer la nouvelle salle comme visitÃ©e.

---

#### 1ï¸âƒ£ Instructions

1. CrÃ©er une fonction `DeplacerJoueur(string choix)`.
2. VÃ©rifier la direction choisie (`N`, `S`, `O`, `E`).
3. Mettre Ã  jour `positionLigne` ou `positionColonne` seulement si le dÃ©placement est possible (ne pas sortir du donjon).
4. Si le choix est invalide â†’ afficher `"Choix invalide."`.
5. Marquer la nouvelle position comme **visitÃ©e** dans `donjonVisite`.

---

#### 2ï¸âƒ£ Pseudo-code

```pseudo
fonction DeplacerJoueur(choix)
    si choix == "N" et positionLigne > 0
        positionLigne--
    sinon si choix == "S" et positionLigne < donjon.GetLength(0) - 1
        positionLigne++
    sinon si choix == "O" et positionColonne > 0
        positionColonne--
    sinon si choix == "E" et positionColonne < donjon.GetLength(1) - 1
        positionColonne++
    sinon
        afficher "Choix invalide"

    donjonVisite[positionLigne, positionColonne] = vrai
fin fonction
```

---

#### 3ï¸âƒ£ Test rapide

Ajoute dans ta fonction `Tests()` :

```csharp
positionLigne = 1; positionColonne = 1; // dÃ©part au centre
AfficherDonjon();

DeplacerJoueur("N"); // vers le nord
AfficherDonjon();

DeplacerJoueur("O"); // vers lâ€™ouest
AfficherDonjon();

DeplacerJoueur("X"); // choix invalide
```

---

#### ğŸ¬ RÃ©sultat attendu

- Le joueur (`ğŸ˜ƒ`) se dÃ©place dans le donjon selon les directions valides.  
- Si une case est revisitÃ©e â†’ elle reste marquÃ©e comme visitÃ©e (`donjonVisite[ligne, colonne] = true`).  
- Un choix invalide affiche `"Choix invalide."` et ne dÃ©place pas le joueur.  

### Ã‰tape 6 â€” Fin de la partie

#### ğŸ¯ Objectif

Valider que le joueur la position du jouer et regarder s'il a rÃ©cupÃ©rer la clÃ©.

---

#### 1ï¸âƒ£ Instructions
1. Ajouter une variable globale pour savoir le joueur possede la clÃ©
```csharp
// Devient true lorsqu'on est sur "ğŸ—"
static bool possedeCle = false;
```
ğŸ‘‰ Lorsque l'on se dÃ©place dans la salle contenant `"ğŸ—"`, la variable `possedeCle` devient Ã©gale Ã  `true`
2. CrÃ©er une fonction `FinDePartie()`.
3. VÃ©rifier si le joueur est sur la porte de sortie `"ğŸšª"`.
4. VÃ©rifier si le joueur a rÃ©cupÃ©rer la clÃ© pour dÃ©barrer la porte `"ğŸ—"`.
5. Si le joueur est sur la porte, **mais il n'est pas en possession de la clÃ©**, afficher `"La porte est verrouillÃ©e. Vous avez besoin de la clÃ©."`.
6. Si le joueur est sur la porte **et qu'il possede la clÃ©**, afficher un message de victoire `"  ğŸ‰ Victoire! ğŸ¥³  "` et **retourne la valeur `true`**.

---

#### 2ï¸âƒ£ Pseudo-code

```pseudo
fonction FinDePartie()
    si donjon[positionLigne, positionColonne] != "ğŸšª"
        retourne faux
    
    si !possedeCle
        afficher "La porte est verrouillÃ©e. Vous avez besoin de la clÃ©."
        retourne faux
    sinon
        afficher "  ğŸ‰ Victoire! ğŸ¥³  "
        retourne vrai
fin fonction
```

---

#### âœ… Test rapide

Ajoute dans ta fonction `Tests()` :

```csharp
possedeCle = false;
positionLigne = 2; positionColonne = 0; // dÃ©part sur la porte
FinDePartie(); // On a besoin de la clÃ©

positionLigne = 0; positionColonne = 0; // une position diffÃ©rente de la porte
FinDePartie(); // On n'est pas sur la porte, la fonction n'affiche rien

possedeCle = true;
positionLigne = 2; positionColonne = 0; // dÃ©part sur la porte
FinDePartie(); // Victoire!
```

---

#### ğŸ¬ RÃ©sultat attendu

- Lorsque le joueur est sur une casse diffÃ©rente de `"ğŸšª"`, la fonction n'affiche rien et elle retourne `false`.
- Lorsque le joueur est sur une casse diffÃ©rente de `"ğŸšª"`, mais qu'il ne possÃ¨de pas la `"ğŸ—"`, la fonction affiche que la porte est barrÃ©e et elle retourne `false`.  
- Lorsque le joueur est sur la casse `"ğŸšª"` et qu'il possÃ¨ede la `"ğŸ—"`, la fonction affiche un message de victoire, elle retourne `true` et le jeu se termine (on quitte la boucle du menu de navigation).
:::danger Attention!
Tu devras placer la fonction FinDePartie() au bon endroit dans ta boucle du menu de navigation pour Ãªtre capable de quitter le seul lors de la victoire
:::
---



## ğŸ”¹ Progression

##### Partie 2 â€“ CrÃ©er de nouveaux donjons
1. PrÃ©parer le fichier donjon.csv
2. Charger le nouveau donjon

---
## ğŸ—ºï¸ Partie 2 â€“ CrÃ©er de nouveaux donjons

---
### Ã‰tape 1 â€” PrÃ©parer le fichier donjon.csv

#### ğŸ¯ Objectif

Mettre en place un **fichier csv (donjon.csv)** dans lequel le vous pourrez crÃ©er de nouvelles cartes pour votre jeu. 

---


#### 1ï¸âƒ£ DÃ©finir le donjon

On reprendra le donjon de base.

```csharp
static string[,] donjon = new string[3, 3]
{
    { "ğŸ—¿", "ğŸ’€", "ğŸ’" },
    { "ğŸ‘¹", "ğŸ§™â€", "ğŸ—" },
    { "ğŸšª", "ğŸ§Ÿ", "ğŸ‘º" }
};
```

On pourra ensuite le transformer en fichier csv
```
ğŸ—¿;ğŸ’€;ğŸ’
ğŸ‘¹;ğŸ§™â€;ğŸ—
ğŸšª;ğŸ§Ÿ;ğŸ‘º
```

Sauvegarder donjon.csv Ã  la **racine de votre projet** (dans le mÃªme dossier que Program.cs)
<Row>
<Column>

![Projet](_03-tp3/projet.png)

</Column>
<Column>

</Column>
</Row>

---

#### âœ… Test rapide

Ouvrir le fichier `donjon.csv` avec **Excel**.

### Ã‰tape 2 â€” Charger le nouveau donjon

#### ğŸ¯ Objectif

Lire le fichier donjon.csv au lancement de l'application et placer le donjon lu dans la variable `string[,] donjon`.

---


#### 1ï¸âƒ£ Instructions

1. CrÃ©er une fonction `ChargerDonjonCSV()`.
2. Trouver le chemin du projet.
3. Ouvrir le fichier donjon.csv.
4. Lire le contenu du fichier.
5. Assigner le contenu du fichier Ã  la variable `string[,] donjon`.

---

#### 2ï¸âƒ£ Pseudo-code

```pseudo
fonction ChargerDonjonCSV()
    chemin = chemin vers donjon.csv

    lignes = new List<string>();
    ouvrir le fichier

    rÃ©pÃ©ter tant que ce n'est pas la fin du fichier
        Lire une fichier
        ajouter la ligne Ã  la liste `lignes`

    nbLignes = Compter le nombre de lignes
    nbColonnes = Compter le nombre de colonnes

    rÃ©initialiser donjon avec la bonne taille
    rÃ©initialiser donjonVisite avec la bonne taille

    rÃ©pÃ©ter pour chaque ligne

        rÃ©cupÃ©rer la ligne courante dans la liste
        // sÃ©parer les Ã©lÃ©ments de la ligne
        elements = ligne.split(";")

        rÃ©pÃ©ter pour chaque colonne
            assigner l'Ã©lÃ©ment Ã  la bonne case du donjon

    fermer le fichier
fin fonction
```

---

#### 3ï¸âƒ£ Trouver le chemin vers le fichier

Pour trouver le chemin du fichier donjon.csv, nous utiliserons l'emplacement de programme comme point de dÃ©part. Toutefois, le programme est exÃ©cuter dans le dossier bin/Debug/net8.0 si l'on utilise .net 8 ou sinon bin/Debug/net9.0 pour la version 9 de .net.
Nous devrons donc revenir vers l'arriÃ¨re de 3 dossiers en utilisant le chemin relatif.

<Row>
<Column>

![Projet](_03-tp3/fichier.png)

</Column>
<Column>

</Column>
</Row>

##### Comment faire

```csharp
// new DirectoryInfo() donne l'emplacement du programme compilÃ©
// donc le dossier_tp3/bin/Debug/net8.0/ ou encore dossier_tp3/bin/Debug/net9.0/ 
// on remonte de trois niveaux pour atteindre le dossier du projet
DirectoryInfo di = new DirectoryInfo("../../../");      
// On utilise di.FullName pour obtenir le chemin complet du dossier du projet
StreamReader objFichier = new StreamReader(di.FullName + "/donjon.csv");
```

---

#### 4ï¸âƒ£ Utiliser une liste `List`

##### RÃ©fÃ©rence

Vous pouvez vous rÃ©fÃ©rez au besoin Ã  la documention de [Notions C#](https://info.cegepmontpetit.ca/notions-csharp/documentation/liste-generique-list-t)

:::info C'est quoi une liste
- Une liste est une `collection` de variables ou d'objets. 
- Dans le contexte du cours de 1P6, la liste ressemble beaucoup Ã  un tableau 1D
    - **La diffÃ©rence** c'est que la **taille du tableau est fixe** dÃ¨s le dÃ©part, alors qu'une **liste s'agrandie** lorsqu'on lui ajoute un item. 
:::

##### CrÃ©er une liste
On crÃ©e une nouvelle liste avec le **mot clÃ©** `new` plus de dÃ©tail
```csharp
List<string> lignesDuFichier = new List<string>();
```
- `List` type utilisÃ© pour crÃ©er une liste
- `<string>` type de donnÃ©es contenu dans la liste
    - L'Ã©quivalent pour un tableau serait `string[]`
- `new List<string>()` crÃ©ation d'une nouvelle liste
    - L'Ã©quivalent pour un tableau serait `new string[taille]`
    - Pour le tableau `taille` doit Ãªtre connu dÃ¨s le dÃ©part

##### Ajouter des donnÃ©es

Il suffit d'utiliser la fonction `Add`
```csharp
List<string> liste = new List<string>();

liste.Add("nouveau texte dans la liste");
```

##### Lire les donnÃ©es

On peut lire les donner comme un tableau
```csharp
List<int> liste = new List<int>();
// ...
int deuxiemeElement = liste[1] // pour accÃ©der Ã  l'item Ã  l'index 1

// parcourir la liste pour accÃ©der aux Ã©lÃ©ments 1 Ã  1
for(int i = 0; i < liste.Length; i++) 
{
    int element  = liste[i];
}
```

##### Besoin d'en plus?

Pour avoir plus d'informations, pouvez vous rÃ©fÃ©rez Ã  la documention de [Notions C#](https://info.cegepmontpetit.ca/notions-csharp/documentation/liste-generique-list-t)

---

#### âœ… Test rapide

Ajoute dans `Tests()` :

```csharp

AfficherDonjon();
```

---

#### ğŸ¬ RÃ©sultat attendu

- Le nouveau donjon devrait pourvoir s'afficher correctement!.